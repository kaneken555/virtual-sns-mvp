services:
  backend:
    build: ./backend
    container_name: sns-backend
    env_file: ./backend/.env
    ports: ["8000:8000"]
    depends_on: [redis, postgres]
    volumes: ["./backend/app:/app/app"]

  worker:
    build: ./backend
    container_name: sns-worker
    command: celery -A app.workers.celery_app.celery_app worker --loglevel=INFO
    env_file: ./backend/.env
    depends_on: [redis, postgres]
    volumes: ["./backend/app:/app/app"]

  redis:
    image: redis:7
    container_name: sns-redis
    ports: ["6379:6379"]

  postgres:
    image: postgres:16
    container_name: sns-pg
    environment:
      POSTGRES_USER: app
      POSTGRES_PASSWORD: app
      POSTGRES_DB: virtualsns
    ports: ["5432:5432"]
